<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Twin City Simulation</title>
    <link rel="stylesheet" href="style.css">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <i class="fas fa-city"></i>
            <h1>Digital Twin City Simulation</h1>
        </div>
        <div class="header-right">
            <span class="status-badge" id="status-badge">
                <i class="fas fa-circle"></i>
                <span id="status-text">Connecting...</span>
            </span>
            <span class="device-badge" id="device-badge">
                <i class="fas fa-microchip"></i>
                <span id="device-text">CPU</span>
            </span>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- System Status -->
            <div class="panel">
                <h3><i class="fas fa-server"></i> System Status</h3>
                <div class="status-grid">
                    <div class="status-item">
                        <span class="label">Model</span>
                        <span class="value" id="model-status">--</span>
                    </div>
                    <div class="status-item">
                        <span class="label">Graph</span>
                        <span class="value" id="graph-status">--</span>
                    </div>
                    <div class="status-item">
                        <span class="label">Nodes</span>
                        <span class="value" id="node-count">--</span>
                    </div>
                    <div class="status-item">
                        <span class="label">Edges</span>
                        <span class="value" id="edge-count">--</span>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="panel">
                <h3><i class="fas fa-sliders-h"></i> Controls</h3>
                
                <div class="control-group">
                    <label>Visualization Layers</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="layer-roads" checked>
                            <span class="checkmark"></span>
                            Roads
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="layer-metro" checked>
                            <span class="checkmark"></span>
                            Metro Lines
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="layer-nodes" checked>
                            <span class="checkmark"></span>
                            Nodes
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="layer-amenities" checked>
                            <span class="checkmark"></span>
                            Amenities
                        </label>
                    </div>
                </div>

                <div class="control-group">
                    <label>Actions</label>
                    <button class="btn btn-primary" id="btn-predict">
                        <i class="fas fa-brain"></i> Run Prediction
                    </button>
                    <button class="btn btn-secondary" id="btn-reset">
                        <i class="fas fa-undo"></i> Reset View
                    </button>
                    <button class="btn btn-analysis" id="btn-analysis">
                        <i class="fas fa-chart-bar"></i> View Analysis
                    </button>
                </div>
            </div>

            <!-- Road Closure -->
            <div class="panel">
                <h3><i class="fas fa-road"></i> Road Closure Test</h3>
                <p class="hint">Click edges on the map to close/open roads</p>
                <div class="closed-roads-list" id="closed-roads-list">
                    <p class="empty-message">No roads closed</p>
                </div>
                <button class="btn btn-danger" id="btn-clear-closures">
                    <i class="fas fa-trash"></i> Clear All
                </button>
            </div>

            <!-- Statistics -->
            <div class="panel">
                <h3><i class="fas fa-chart-bar"></i> Traffic Statistics</h3>
                <div class="stats-grid" id="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Mean Congestion</div>
                        <div class="stat-value" id="stat-mean">--</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Max Congestion</div>
                        <div class="stat-value" id="stat-max">--</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Road Avg</div>
                        <div class="stat-value" id="stat-road">--</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Metro Avg</div>
                        <div class="stat-value" id="stat-metro">--</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Map Container -->
        <main class="map-container">
            <div id="map"></div>
            
            <!-- Map Legend -->
            <div class="map-legend">
                <h4>üó∫Ô∏è Legend</h4>
                <div class="legend-section">
                    <strong>Transport</strong>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #3498db;"></span>
                        <span>Road</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #FF0000; height: 4px;"></span>
                        <span>üî¥ Red Line (Metro)</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #0000FF; height: 4px;"></span>
                        <span>üîµ Blue Line (Metro)</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #00FF00; height: 4px;"></span>
                        <span>üü¢ Green Line (Metro)</span>
                    </div>
                </div>
                <div class="legend-section">
                    <strong>Amenities</strong>
                    <div class="legend-item">
                        <span class="legend-dot" style="background: #e74c3c;"></span>
                        <span>üè• Hospital</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot" style="background: #27ae60;"></span>
                        <span>üå≥ Park</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot" style="background: #f39c12;"></span>
                        <span>üè´ School</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot" style="background: #9b59b6;"></span>
                        <span>üöá Metro Station</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot" style="background: #e91e63;"></span>
                        <span>üõí Mall</span>
                    </div>
                </div>
                <div class="legend-section">
                    <strong>Congestion Level</strong>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #c0392b;"></span>
                        <span>Very High (80-100%)</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #e67e22;"></span>
                        <span>High (60-80%)</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #f1c40f;"></span>
                        <span>Medium (40-60%)</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #2ecc71;"></span>
                        <span>Low (20-40%)</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #1e8449;"></span>
                        <span>Very Low (0-20%)</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #ff69b4; border: 2px dashed #ff69b4;"></span>
                        <span>üö´ Blocked Road</span>
                    </div>
                </div>
            </div>

            <!-- Info Panel -->
            <div class="info-panel" id="info-panel">
                <button class="close-btn" id="close-info">&times;</button>
                <h4 id="info-title">Node Info</h4>
                <div id="info-content"></div>
            </div>
        </main>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="spinner"></div>
        <p id="loading-text">Loading...</p>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="app.js"></script>
</body>
</html>
